# PROJECT CMAKE FILE
# This file is autogenerated by the creator script
cmake_minimum_required(VERSION 3.10)

# set the project name and version
project(Ship VERSION 1.0)

# Policy to pass options to CUGL
if(POLICY CMP0077)
	set(CMAKE_POLICY_DEFAULT_CMP0077 NEW)
endif()

# Need all this for Linux
if (UNIX AND NOT APPLE)
  include(CheckLibraryExists)
  include(CheckIncludeFiles)
  include(CheckIncludeFile)
  include(CheckLanguage)
  include(CheckSymbolExists)
  include(CheckCSourceCompiles)
  include(CheckCSourceRuns)
  include(CheckCCompilerFlag)
  include(CheckCXXCompilerFlag)
  include(CheckStructHasMember)
  include(CMakeDependentOption)
  include(CMakePushCheckState)
  include(GNUInstallDirs)
endif()

# specify the C++ standard
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED True)

# We really want there to be only one shared library
option(BUILD_SHARED_BASE "Build the SDL component as a shared library" OFF)

# Set the correct directories
set(CUGL_DIR  "${PROJECT_SOURCE_DIR}/../../../../../../cugl")
set(SDL3_DIR  "${CUGL_DIR}/sdlapp")
set(BOX2_DIR  "${CUGL_DIR}/external/box2d")
set(WRTC_DIR  "${CUGL_DIR}/external/libdatachannel")
set(POLY2_DIR "${CUGL_DIR}/external/poly2tri")
set(ASSET_DIR "${PROJECT_SOURCE_DIR}/../../../../../assets")
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/install")

list(APPEND EXTRA_INCLUDES "${SDL3_DIR}/include")
list(APPEND EXTRA_INCLUDES "${CUGL_DIR}/include")
list(APPEND EXTRA_INCLUDES "${BOX2_DIR}/include")
list(APPEND EXTRA_INCLUDES "${POLY2_DIR}/include")
list(APPEND EXTRA_INCLUDES "${WRTC_DIR}/include")


# Link in cugl
set(CUGL_BACKEND "opengl" CACHE STRING "" FORCE)
set(CUGL_AUDIO ON)
set(CUGL_SCENE2 ON)
set(CUGL_SCENE3 OFF)
set(CUGL_PHYSICS2 OFF)
set(CUGL_NETCODE OFF)
set(CUGL_PHYSICS2_DISTRIB OFF)
set(CUGL_PHYSICS2_LIGHTS OFF)
add_subdirectory(cugl)
list(APPEND EXTRA_LIBS cugl)

# Add any external libraries


# Add the source code
file(GLOB SOURCE_FILES
    ${PROJECT_SOURCE_DIR}/../../../../../source/*.cpp
    ${PROJECT_SOURCE_DIR}/../../../../../source/*.h)

# Build and link
set(ANDROID_LIBS EGL GLESv1_CM GLESv2 GLESv3 log android)
add_library(main SHARED)
target_link_options(main PRIVATE "LINKER:-u,SDL_main")   # Android NEEDS this
target_sources(main PRIVATE ${SOURCE_FILES})
target_include_directories(main PUBLIC
                           "${PROJECT_BINARY_DIR}"
                            ${EXTRA_INCLUDES}
                           )
target_link_libraries(main ${EXTRA_LIBS} ${ANDROID_LIBS})

